TODO:
  - Error handling.
  - Header restoration.
